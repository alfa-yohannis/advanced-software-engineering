\chapter{Pendekatan Berbasis Model untuk Otomasi Infrastruktur}\label{chap:mde-otomasi}

\section*{Tujuan Pembelajaran}

Setelah mempelajari bab ini, capaian pembelajaran yang diharapkan adalah sebagai berikut:

\begin{enumerate}
    \item Memahami konsep \textit{Model-Driven Engineering} (MDE) dalam konteks otomasi infrastruktur perangkat lunak.
    \item Menjelaskan peran model, aturan transformasi, dan template dalam menghasilkan artefak \textit{Infrastructure as Code} (IaC) yang konsisten antar environment.
    \item Menganalisis penerapan pendekatan berbasis model pada studi kasus proyek ini, mulai dari model input hingga artefak deployment Terraform dan Kubernetes.
\end{enumerate}

\section{Pendahuluan}\label{sec:mde-pendahuluan}

Pada bab sebelumnya, infrastruktur dibahas sebagai kode melalui pendekatan \textit{Infrastructure as Code} (IaC). Pendekatan tersebut memungkinkan definisi infrastruktur secara deklaratif dan terversi. Ketika jumlah environment bertambah serta variasi konfigurasi meningkat, pengelolaan langsung pada level berkas IaC masih berpotensi menimbulkan duplikasi, deviasi konfigurasi, dan beban pemeliharaan jangka panjang.

Pendekatan berbasis model memperkenalkan tingkat abstraksi yang lebih tinggi. Fokus utama berada pada model konfigurasi inti, kemudian artefak teknis seperti Terraform dan Kubernetes dihasilkan melalui transformasi otomatis. Pola ini mendukung standardisasi lintas environment, ketertelusuran perubahan, dan efisiensi proses evolusi sistem.

\section{Latar Belakang dan Motivasi}\label{sec:mde-latar-belakang}

Praktik DevOps modern umumnya mengelola environment \texttt{dev}, \texttt{staging}, dan \texttt{prod}. Perbedaan kebutuhan sering muncul pada jumlah replika, kebijakan ketersediaan, dan pengelolaan variabel sensitif. Pengeditan manual pada banyak berkas cenderung menghasilkan duplikasi konfigurasi, inkonsistensi antar environment, kesulitan perubahan global, serta jejak keputusan teknis yang kurang jelas.

MDE menjawab persoalan tersebut melalui tiga elemen yang saling terkait. Pertama, model diposisikan sebagai sumber kebenaran konfigurasi. Kedua, aturan transformasi memetakan model ke artefak implementasi. Ketiga, template menjaga bentuk output agar seragam. Kombinasi ketiganya memungkinkan variasi environment tetap fleksibel tanpa mengorbankan konsistensi.

\section{Konsep Model-Driven Engineering}\label{sec:mde-konsep}

\subsection{Metamodel, Model, dan Instance}\label{subsec:mde-metamodel-model-instance}

Metamodel mendefinisikan bentuk valid dari model, termasuk atribut wajib, tipe data, dan relasi yang diizinkan. Model menyatakan konfigurasi pada tingkat abstraksi domain, misalnya parameter environment dan aturan variasi. Instance merupakan hasil konkret dari model setelah transformasi dieksekusi, misalnya berkas Terraform dan Kubernetes untuk environment tertentu. Relasi ketiga tingkat abstraksi tersebut ditunjukkan pada Gambar~\ref{fig:mde-metamodel-model-instance}.

\begin{figure}[htbp]
\centering
\scalebox{0.7}{%
\begin{tikzpicture}[
  font=\small,
  >=latex,
  thick,
  box/.style={draw, rounded corners, minimum width=4.6cm, minimum height=2.4cm, align=center},
  lbl/.style={align=center}
]
  \node[box, fill=green!8] (metamodel) {
    \textbf{Metamodel}\\[2pt]
    Skema model\\atribut, tipe, relasi
  };

  \node[box, fill=blue!8, right=20mm of metamodel] (model) {
    \textbf{Model}\\[2pt]
    Konfigurasi abstrak\\environment
  };

  \node[box, fill=orange!10, right=20mm of model, minimum width=5.4cm] (instance) {
    \textbf{Instance}\\[2pt]
    Artefak konkret\\Terraform dan Kubernetes
  };

  \draw[->] (metamodel.east) -- (model.west) node[midway, above, lbl] {conformance};
  \draw[->] (model.east) -- (instance.west) node[midway, above, lbl] {transformasi};

\end{tikzpicture}
}%
\caption{Relasi metamodel, model, dan instance pada pendekatan MDE untuk otomasi infrastruktur.}
\label{fig:mde-metamodel-model-instance}
\end{figure}

Diagram pada Gambar~\ref{fig:mde-metamodel-model-instance} menegaskan dua alur utama. Alur pertama adalah conformance antara model dan metamodel, sehingga model yang diproses selalu sesuai skema. Alur kedua adalah transformasi dari model ke instance, sehingga konfigurasi abstrak diproyeksikan menjadi artefak konkret deployment. Struktur ini mendorong reusabilitas karena satu model yang valid dapat menghasilkan banyak instance untuk environment berbeda dengan pola keluaran yang konsisten.

\textbf{Contoh 1.} Pada perancangan rumah, metamodel menetapkan aturan gambar yang valid, misalnya harus ada ukuran ruangan, simbol pintu, dan simbol jendela. Model adalah blueprint rumah tipe tertentu yang mengikuti aturan tersebut. Instance adalah rumah fisik yang dibangun berdasarkan blueprint itu, dengan ukuran dan posisi ruang yang konkret.

\textbf{Contoh 2.} Pada manufaktur berbasis 3D printer, metamodel mendefinisikan struktur desain, misalnya objek harus memiliki dimensi, ketebalan minimum, dan format berkas tertentu. Model adalah rancangan komponen elektronik, misalnya casing sensor, yang telah sesuai aturan desain. Instance adalah hasil cetak nyata dari 3D printer berupa satu komponen fisik yang siap dipasang pada perangkat elektronik.

\subsection{Pemodelan Tekstual untuk Infrastruktur}\label{subsec:mde-pemodelan-tekstual}

Pemodelan tekstual menggunakan format yang mudah dibaca manusia dan mudah diproses mesin, misalnya YAML. Pilihan ini mendukung \textit{version control}, \textit{code review}, dan validasi otomatis. Integrasi dengan pipeline CI/CD juga lebih langsung karena tidak membutuhkan tooling visual khusus.

\subsection{Generasi Kode dalam Alur Kerja DevOps}\label{subsec:mde-generasi-kode}

Generasi kode ditempatkan setelah pembaruan model dan sebelum provisioning/deployment. Urutan proses dimulai dari pembaruan model environment, dilanjutkan eksekusi generator berbasis template, verifikasi artefak hasil generasi, kemudian penerapan artefak ke environment target. Pemisahan antara \textit{what to configure} dan \textit{how to materialize} membuat perubahan lebih terkontrol.

\section{Keuntungan dan Kerugian Umum Pendekatan MDE}\label{sec:mde-keuntungan-kerugian-umum}

Secara umum, MDE menawarkan efisiensi tinggi pada pengelolaan sistem yang memiliki banyak variasi konfigurasi, tetapi membutuhkan investasi awal pada desain model dan pipeline transformasi.

\subsection{Keuntungan Umum}\label{subsec:mde-keuntungan-umum}

Keuntungan umum yang paling sering diperoleh dari pendekatan MDE meliputi konsistensi artefak lintas environment, pengurangan duplikasi konfigurasi, peningkatan ketertelusuran perubahan, serta percepatan pembuatan varian baru karena perubahan dipusatkan di level model. MDE juga mendorong standardisasi tim karena aturan teknis tersimpan eksplisit pada model, template, dan transformasi.

\subsection{Kerugian Umum}\label{subsec:mde-kerugian-umum}

Kerugian umum MDE berada pada biaya adopsi awal, terutama saat merancang metamodel, struktur template, dan pengujian generator. Kompleksitas debugging juga dapat meningkat karena sumber masalah bisa muncul pada beberapa lapisan sekaligus, yaitu model, transformasi, atau template. Risiko lain adalah \textit{over-engineering} jika domain masalah sebenarnya sederhana, sehingga biaya pemeliharaan kerangka MDE tidak sebanding dengan manfaat yang diperoleh.

\section{Contoh Aplikasi MDE di Dunia Industri}\label{sec:mde-industri}

Penerapan MDE di dunia industri umumnya muncul pada domain dengan kompleksitas sistem tinggi, regulasi ketat, dan kebutuhan variasi produk yang besar. Pada kondisi tersebut, pendekatan berbasis model membantu menjaga konsistensi desain sekaligus mempercepat proses turunan produk.

\subsection{Sektor dan Pola Penggunaan}\label{subsec:mde-sektor-penggunaan}

Pada industri otomotif, MDE banyak dipakai untuk rekayasa perangkat lunak kendaraan, arsitektur ECU, dan integrasi sistem berbasis standar seperti AUTOSAR. Pada industri aviasi dan pertahanan, pola penggunaan berfokus pada \textit{model-based systems engineering} untuk desain sistem lintas disiplin, analisis dependensi, dan ketertelusuran kebutuhan hingga implementasi. Pada industri manufaktur dan otomasi, MDE sering dipakai untuk \textit{digital twin}, desain lini produksi, serta rekayasa konfigurasi sistem kontrol.

\subsection{Contoh Perusahaan}\label{subsec:mde-contoh-perusahaan}

Perusahaan yang sering diasosiasikan dengan praktik berbasis model meliputi Siemens, Bosch, BMW Group, Mercedes-Benz, Volkswagen Group, Airbus, Boeing, ABB, dan Schneider Electric. Bentuk implementasi di tiap perusahaan dapat berbeda, mulai dari level pemodelan arsitektur, generasi konfigurasi, hingga otomasi artefak implementasi dan validasi.

\subsection{Relevansi untuk Proyek Ini}\label{subsec:mde-relevansi-proyek}

Relevansi terhadap proyek ini terletak pada prinsip yang sama: variasi konfigurasi dikelola pada level model, kemudian diturunkan menjadi instance deployment secara otomatis. Meskipun skala proyek berbeda dari skala industri besar, pola \textit{single source of truth}, transformasi terstruktur, dan generasi artefak konsisten tetap sejalan dengan praktik industrial MDE.

\section{Potensi Pendekatan MDE dalam Praktik DevOps}\label{sec:mde-devops-potensi}

Potensi utama MDE dalam DevOps berada pada kemampuan menyatukan desain konfigurasi, otomasi pipeline, dan kontrol kualitas dalam satu alur yang konsisten. Ketika model dipakai sebagai sumber kebenaran, proses CI/CD tidak hanya menjalankan \textit{build-test-deploy}, tetapi juga menegakkan aturan validasi konfigurasi sebelum artefak deployment dibentuk.

\subsection{Integrasi dengan Pipeline CI/CD}\label{subsec:mde-devops-cicd}

Dalam pipeline DevOps, tahap awal dapat memvalidasi model dan metamodel, tahap tengah dapat menjalankan transformasi model ke artefak IaC, dan tahap akhir dapat menjalankan verifikasi sintaks serta kebijakan keamanan sebelum deployment. Pola ini mengurangi kegagalan yang biasanya baru terlihat pada fase runtime, karena banyak kesalahan sudah dicegah di fase model.

\subsection{Dukungan untuk Governance dan Compliance}\label{subsec:mde-devops-governance}

MDE juga berpotensi memperkuat governance karena aturan organisasi dapat ditanamkan pada metamodel dan template. Dengan cara ini, kebijakan seperti standar penamaan resource, batasan konfigurasi sensitif, atau kewajiban komponen keamanan dapat diterapkan otomatis pada seluruh environment tanpa inspeksi manual berulang.

\subsection{Skalabilitas Operasional Multi-Environment}\label{subsec:mde-devops-multienv}

Pada organisasi dengan banyak environment dan banyak tim, MDE membantu menjaga ritme perubahan tetap cepat tanpa mengorbankan konsistensi. Penambahan environment baru dapat dilakukan lewat perubahan model yang terbatas, lalu dipropagasikan melalui pipeline ke artefak instance yang seragam. Pendekatan ini sangat relevan untuk DevOps modern yang menuntut frekuensi rilis tinggi dan reliabilitas konfigurasi yang stabil.

\section{Pendekatan Berbasis Model yang Diusulkan}\label{sec:mde-pendekatan}

Pendekatan pada proyek ini menempatkan model dan template sebagai dua input utama bagi mesin transformasi. Model menyediakan data dan variasi environment, sedangkan template menyediakan struktur artefak target. Komponen utama serta alur kerja antar komponen dirangkum pada Gambar~\ref{fig:mde-pendekatan-arsitektur}.

\begin{figure}[htbp]
\centering
\scalebox{0.6}{%
\begin{tikzpicture}[
  font=\small,
  >=latex,
  thick,
  box/.style={draw, rounded corners, minimum width=4.8cm, minimum height=2cm, align=center},
  lbl/.style={align=center}
]
  \node[box, fill=blue!8] (models) {
    \textbf{Models}\\[2pt]
    \texttt{environments.yaml}\\\texttt{files.yaml}
  };

  \node[box, fill=orange!10, below=5mm of models] (templates) {
    \textbf{Templates}\\[2pt]
    Jinja2 Terraform\\dan Kubernetes
  };

  \node[box, fill=green!8, right=25mm of models, minimum width=5.2cm] (transformers) {
    \textbf{Transformers}\\[2pt]
    \texttt{generate.py}\\merge context + render
  };

  \node[box, fill=purple!10, right=20mm of transformers, minimum width=5.4cm] (output) {
    \textbf{Output IaC}\\[2pt]
    \texttt{outputs/terraform}\\\texttt{outputs/kubernetes}
  };

  \draw[->] (models.east) -- (transformers.west) node[midway, above, lbl] {input model};
  \draw[->] (templates.east) -- (transformers.south west) node[midway, below, lbl, yshift=-8mm] {input template};
  \draw[->] (transformers.east) -- (output.west) node[midway, above, lbl] {generate};

  \node[box, fill=gray!10, below=10mm of transformers, xshift=30mm, minimum width=5.2cm, minimum height=1.2cm] (mekanisme) {
    \textbf{Mekanisme Kerja}\\
    validasi model, evaluasi \texttt{when}, atribut turunan, dan rendering
  };

  \draw[->, dashed] (transformers.south) -- (mekanisme.north);
\end{tikzpicture}
}%
\caption{Pendekatan berbasis model dengan dua input ke mesin transformasi: models dan templates.}
\label{fig:mde-pendekatan-arsitektur}
\end{figure}

Diagram pada Gambar~\ref{fig:mde-pendekatan-arsitektur} menunjukkan bahwa mesin transformasi menerima dua masukan secara bersamaan, yaitu model dan template. Model dipakai untuk membentuk context environment dan mengevaluasi kondisi konfigurasi, sedangkan template dipakai sebagai kerangka sintaks artefak target. Keluaran proses adalah artefak IaC konkret yang siap dipakai untuk deployment.

\subsection{Model Sumber}\label{subsec:mde-model-sumber}

Model sumber pada proyek ini berada di \texttt{mde/models}. Berkas \texttt{environments.yaml} memuat \textit{defaults} global dan daftar environment. Atribut turunan seperti \texttt{k8s\_overlay}, \texttt{mp3\_bucket}, dan \texttt{tfvars\_filename} dapat dibentuk otomatis dari nama environment. Berkas \texttt{files.yaml} memetakan template ke jalur output, sehingga definisi transformasi terpusat dan mudah diaudit.

\subsection{Aturan Transformasi}\label{subsec:mde-aturan-transformasi}

Aturan transformasi diimplementasikan pada \texttt{mde/transformers/generate.py}. Proses dimulai dari pemuatan model YAML, penggabungan \textit{defaults} dengan override environment, pembentukan atribut turunan, evaluasi kondisi \texttt{when} untuk artefak opsional, lalu rendering template Jinja2 ke direktori keluaran. Struktur ini menjaga model tetap ringkas namun tetap mampu menghasilkan artefak deployment lengkap.

\subsection{Generasi Artefak Berbasis Template}\label{subsec:mde-template}

Template berada di \texttt{mde/templates} dan dipisahkan ke template inti serta template spesifik environment. Template inti dipakai untuk artefak bersama lintas environment, sedangkan template environment menggunakan context model untuk menyisipkan variasi nilai. Pendekatan ini menekan duplikasi dan menjaga konsistensi struktur berkas hasil generasi.

\subsection{Ketertelusuran dari Model ke Artefak Deployment}\label{subsec:mde-traceability}

Ketertelusuran dijaga melalui rantai model $\rightarrow$ aturan transformasi $\rightarrow$ template $\rightarrow$ artefak akhir. Ketika perubahan perilaku deployment terjadi, sumber perubahan dapat ditelusuri ke level model, logika generator, atau template. Pemisahan tanggung jawab tersebut memperkuat auditabilitas dan mengurangi risiko perubahan tidak terkontrol.

\section{Pendalaman Komponen Folder \texttt{mde}}\label{sec:mde-komponen-folder}

Folder \texttt{mde} berperan sebagai inti otomasi berbasis model. Komponen \texttt{models} mendefinisikan konfigurasi dan variasi environment. Komponen \texttt{transformers} menjalankan aturan transformasi. Komponen \texttt{templates} mematerialisasi konteks model menjadi sintaks Terraform dan Kubernetes.

\begin{lstlisting}[language=bash,caption={Listing: Struktur komponen utama folder mde}]
mde/
|-- README.md
|-- models/
|   |-- environments.yaml
|   `-- files.yaml
|-- transformers/
|   |-- generate.py
|   `-- requirements.txt
`-- templates/
    |-- core/
    |   |-- terraform/modules/tts_stack/*.j2
    |   `-- kubernetes/base/*.j2
    |-- terraform/env/*.j2
    `-- kubernetes/overlay/*.j2
\end{lstlisting}

\subsection{Komponen \texttt{models}: Definisi Variasi Environment}\label{subsec:mde-models}

Direktori \texttt{models} menyimpan model deklaratif sistem melalui \texttt{environments.yaml} dan \texttt{files.yaml}. Berkas pertama memuat \textit{defaults} dan daftar environment, sedangkan berkas kedua mendefinisikan aturan render dari template ke berkas output. Struktur ini membuat variasi environment terlihat eksplisit pada level model.

\begin{lstlisting}[language=bash,caption={Listing: Cuplikan model environment (mde/models/environments.yaml)}]
defaults:
  worker_replicas: 1
  include_replicas_patch: false
  include_pdb: false
  api_image_tag: "{{ env_name }}"

environments:
  - name: dev

  - name: staging
    worker_replicas: 2

  - name: prod
    worker_replicas: 4
    include_pdb: true
\end{lstlisting}

Relasi model-ke-artefak pada \texttt{files.yaml} menggunakan atribut \texttt{when} untuk mengatur berkas opsional. Pendekatan ini mengikat keputusan desain ke model sehingga alasan keberadaan suatu berkas dapat ditelusuri secara langsung.

\begin{lstlisting}[language=bash,caption={Listing: Cuplikan aturan render file (mde/models/files.yaml)}]
env_files:
  - template: terraform/env/tfvars.j2
    output: terraform/{{ name }}/{{ tfvars_filename }}

  - template: kubernetes/overlay/patch-replicas.yaml.j2
    output: kubernetes/overlays/{{ k8s_overlay }}/patch-replicas.yaml
    when: include_replicas_patch

  - template: kubernetes/overlay/pdb-api.yaml.j2
    output: kubernetes/overlays/{{ k8s_overlay }}/pdb-api.yaml
    when: include_pdb
\end{lstlisting}

\subsection{Komponen \texttt{transformers}: Mesin Eksekusi Aturan}\label{subsec:mde-transformers}

Direktori \texttt{transformers} berisi logika transformasi pada \texttt{generate.py}. Fungsi pembentuk context memperlihatkan penggunaan \textit{derived attributes} agar model tetap ringkas tetapi context render tetap lengkap dan konsisten.

\begin{lstlisting}[style=PythonStyle,caption={Listing: Cuplikan fungsi pembentuk context (mde/transformers/generate.py)}]
def enrich_environment_context(defaults, env_cfg, output_root):
    context = merge_dicts(defaults, env_cfg)

    name = str(context["name"])
    context["env_name"] = name

    context.setdefault("k8s_overlay", name)
    context.setdefault("mp3_bucket", f"tts-{name}")
    context.setdefault("internal_token", f"changeme-{name}")
    context.setdefault("tfvars_filename", f"{name}.tfvars")

    return context
\end{lstlisting}

Fungsi evaluasi kondisi berikut memperlihatkan bahwa keputusan render berkas opsional ditentukan oleh nilai context hasil model.

\begin{lstlisting}[style=PythonStyle,caption={Listing: Cuplikan evaluasi kondisi file opsional (mde/transformers/generate.py)}]
def should_render(record, context):
    condition = record.get("when")
    if not condition:
        return True
    return bool(context.get(condition, False))
\end{lstlisting}

\subsection{Komponen \texttt{templates}: Materialisasi ke Artefak IaC}\label{subsec:mde-templates}

Direktori \texttt{templates} memuat representasi target deployment dalam format Jinja2. Template Terraform menghasilkan \texttt{main.tf} dan \texttt{*.tfvars}, sedangkan template Kubernetes menghasilkan \texttt{kustomization.yaml}, patch, ingress, dan berkas opsional lain sesuai context.

\begin{lstlisting}[style=PythonStyle,caption={Listing: Cuplikan template tfvars (mde/templates/terraform/env/tfvars.j2)}]
mp3_bucket     = "{{ mp3_bucket }}"
internal_token = "{{ internal_token }}"

{% if minio_root_user_from_var %}
minio_root_user = "{{ minio_root_user }}"
{% endif %}

worker_replicas = {{ worker_replicas }}
\end{lstlisting}

\begin{lstlisting}[style=PythonStyle,caption={Listing: Cuplikan template overlay (mde/templates/kubernetes/overlay/kustomization.yaml.j2)}]
resources:
  - ../../base
  - ingress-api.yaml
  - ingress-web.yaml
{% if include_pdb %}
  - pdb-api.yaml
  - pdb-web.yaml
{% endif %}

patchesStrategicMerge:
  - patch-images.yaml
  - patch-hpa-worker.yaml
{% if include_replicas_patch %}
  - patch-replicas.yaml
{% endif %}
\end{lstlisting}

\subsection{Alur End-to-End Komponen \texttt{mde}}\label{subsec:mde-end-to-end}

Alur komponen \texttt{mde} dimulai dari definisi parameter pada \texttt{models}, dilanjutkan pembentukan context dan evaluasi aturan pada \texttt{transformers}, kemudian materialisasi artefak Terraform dan Kubernetes pada \texttt{templates}. Rantai ini menunjukkan bahwa \texttt{mde} berfungsi sebagai kerangka kerja kecil berbasis model untuk pengelolaan deployment multi-environment secara sistematis.

\section{Studi Kasus: Proyek Session-07}\label{sec:mde-studi-kasus}

\subsection{Gambaran Umum Proyek}\label{subsec:mde-gambaran-proyek}

Proyek ini membangun stack layanan \textit{text-to-speech} berbasis microservices. Domain Terraform digunakan untuk provisioning komponen infrastruktur, sedangkan domain Kubernetes dengan Kustomize digunakan untuk orkestrasi layanan aplikasi. Folder \texttt{mde} berfungsi sebagai generator artefak IaC, dan folder \texttt{iac} merepresentasikan artefak deployment untuk environment \texttt{dev}, \texttt{staging}, dan \texttt{prod}.

\subsection{Model Input (\texttt{mde/models/environments.yaml}, \texttt{mde/models/files.yaml})}\label{subsec:mde-model-input}

Berkas \texttt{environments.yaml} memungkinkan override konfigurasi per environment di atas nilai default. Contoh pada repository menunjukkan \texttt{staging} menggunakan \texttt{worker\_replicas = 2}, sedangkan \texttt{prod} menggunakan \texttt{worker\_replicas = 4} dengan \texttt{include\_pdb} aktif. Berkas \texttt{files.yaml} membagi transformasi ke \texttt{core\_files} dan \texttt{env\_files}, sehingga struktur output konsisten dengan variasi parameter yang tetap terkontrol.

\subsection{Mesin Transformasi (\texttt{mde/transformers/generate.py})}\label{subsec:mde-mesin-transformasi}

Generator berjalan secara deterministik: membaca model, menyiapkan context environment, merender template berdasarkan kondisi \texttt{when}, lalu menulis artefak ke direktori target dengan default \texttt{outputs/}. Proses regenerasi dapat diulang dengan hasil struktur yang stabil untuk area yang dikelola generator.

\subsection{Kumpulan Template (Jinja untuk Terraform dan Kubernetes)}\label{subsec:mde-kumpulan-template}

Template environment Terraform menghasilkan \texttt{main.tf} dan \texttt{*.tfvars}. Template overlay Kubernetes menghasilkan \texttt{kustomization.yaml}, patch image, patch HPA, patch replika opsional, ingress, serta PDB opsional. Satu template dapat dipakai lintas environment karena variasi dikendalikan oleh context model.

\subsection{Output Hasil Generasi (\texttt{outputs/terraform}, \texttt{outputs/kubernetes})}\label{subsec:mde-output-generasi}

Secara desain, keluaran generasi ditempatkan di \texttt{outputs}. Pada repository ini, bentuk target yang setara terlihat pada \texttt{iac/terraform/*} dan \texttt{iac/kubernetes/*}. Pemisahan area pemodelan dan area konsumsi deployment membuat alur kerja lebih terstruktur dan mudah ditelusuri.

\subsection{Skenario Contoh: Menambahkan Environment Baru (mis. \texttt{qa})}\label{subsec:mde-skenario-qa}

Penambahan environment baru dilakukan dengan menambahkan entri \texttt{qa} pada \texttt{environments.yaml}, menetapkan override yang diperlukan, menjalankan generator, lalu meninjau artefak Terraform dan Kubernetes hasil generasi. Pendekatan ini menghindari penyalinan folder manual dan menjaga konvensi struktur secara konsisten.

\subsection{Artefak Deployment yang Dihasilkan dan Variasi Environment}\label{subsec:mde-variasi-environment}

Variasi environment dapat diamati pada perbedaan artefak \texttt{dev} dan \texttt{prod}. Konfigurasi \texttt{dev} cenderung minimal, sedangkan \texttt{prod} memuat replika lebih tinggi, patch replika aktif, dan resource PDB pada overlay Kubernetes. Perbedaan ini menunjukkan fungsi MDE sebagai mekanisme formal pengelolaan variasi environment.

\section{Evaluasi}\label{sec:mde-evaluasi}

\subsection{Dampak Kualitatif Pendekatan}\label{subsec:mde-dampak-kualitatif}

Dampak utama pendekatan berbasis model pada studi kasus ini dapat dirangkum sebagai berikut:
\begin{itemize}
    \item Konsistensi antar environment meningkat karena seluruh artefak mengikuti template dan aturan transformasi yang sama.
    \item Upaya konfigurasi manual menurun karena perubahan dilakukan pada model terpusat, bukan pada banyak berkas instance.
    \item Maintainability dan skalabilitas membaik karena logika variasi tidak tersebar dan pertambahan environment tidak mendorong duplikasi linear.
    \item Risiko \textit{script explosion} menurun karena variasi dipusatkan pada model dan template, bukan salinan skrip per environment.
    \item Kesalahan konfigurasi menurun, terutama kesalahan salin-tempel, parameter tidak sinkron antar environment, dan berkas yang terlupa diperbarui.
    \item Proses review lebih ringkas, waktu diagnosis lebih pendek, dan \textit{rework} pasca-deployment berkurang karena artefak dibentuk secara deterministik.
\end{itemize}

\subsection{Kerangka Pengukuran Kuantitatif}\label{subsec:mde-pengukuran-kuantitatif}

Pengukuran manfaat dapat dilakukan dengan rancangan \textit{before-after} pada periode yang sama. Langkah pengukuran yang direkomendasikan adalah:
\begin{enumerate}
    \item Ukur tingkat pertumbuhan artefak manual per environment, misalnya rasio pertambahan berkas skrip terhadap pertambahan environment.
    \item Hitung insiden kesalahan konfigurasi per rilis dari jumlah kegagalan deployment akibat mismatch konfigurasi.
    \item Ukur \textit{lead time} perubahan konfigurasi, dari awal edit hingga artefak tervalidasi siap deploy.
    \item Ukur konsistensi output generator, misalnya persentase berkas identik untuk bagian yang seharusnya sama antar environment.
    \item Ukur waktu onboarding environment baru, dari definisi model hingga artefak siap diterapkan.
    \item Ukur perbandingan \textit{Lines of Code} (LoC) antara model dan instance untuk melihat leverage pendekatan berbasis model.
\end{enumerate}

Untuk metrik LoC, gunakan tiga indikator: \textit{Model LoC} (total baris sumber model seperti \texttt{environments.yaml} dan \texttt{files.yaml}), \textit{Instance LoC} (total baris artefak hasil generasi Terraform dan Kubernetes), dan \textit{LoC Compression Ratio} dengan rumus:
$$
\text{Compression Ratio} = \frac{\text{Instance LoC}}{\text{Model LoC}}
$$
Nilai rasio yang lebih tinggi menunjukkan satu baris model menghasilkan lebih banyak baris instance, sehingga beban pemeliharaan berpindah ke level model.

Nilai perbaikan dapat dinyatakan dengan persentase penurunan: 

$$
\frac{\text{nilai awal} - \text{nilai sesudah}}{\text{nilai awal}} \times 100\%
$$

\section{Kesimpulan dan Pekerjaan Lanjutan}\label{sec:mde-kesimpulan}

MDE menyediakan pendekatan sistematis untuk mengelola kompleksitas infrastruktur multi-environment. Pada studi kasus proyek ini, model YAML, generator Python, dan template Jinja2 membentuk rantai transformasi yang jelas dari abstraksi konfigurasi ke artefak deployment.

Pendekatan ini menjaga konsistensi, mengurangi duplikasi, dan mempermudah ekspansi environment. Pekerjaan lanjutan dapat diarahkan pada validasi skema model, pengujian otomatis artefak hasil generasi, dan integrasi pipeline CI agar regenerasi serta verifikasi berjalan pada setiap perubahan model.
