<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Processed Stream</title>
  <style>
    html, body { height:100%; margin:0; background:#0b0b0b; color:#ddd; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; }
    .wrap { height:100%; display:flex; align-items:center; justify-content:center; }
    img { max-width:100vw; max-height:100vh; object-fit:contain; }
    .hud { position:fixed; left:12px; top:10px; font-size:12px; opacity:.75; background:rgba(0,0,0,.35); padding:6px 8px; border-radius:10px; }
  </style>
</head>
<body>
  <div class="hud" id="hud">waiting…</div>
  <div class="wrap">
    <img id="frame" alt="stream" />
  </div>

  <script>
    const img = document.getElementById("frame");
    const hud = document.getElementById("hud");

    // Tune this to match your pipeline (10–15 FPS CCTV-like)
    const intervalMs = 80; // ~12.5 FPS

    async function tick() {
      img.src = "/frame.jpg?t=" + Date.now(); // cache-buster

      try {
        const r = await fetch("/meta.json?t=" + Date.now(), { cache: "no-store" });
        if (r.ok) {
          const m = await r.json();
          hud.textContent = `frame=${m.frame_id ?? "?"}  ${m.w ?? "?"}x${m.h ?? "?"}  mode=${m.mode ?? "?"}`;
        }
      } catch (_) {}
    }

    setInterval(tick, intervalMs);
    tick();
  </script>
</body>
</html>
